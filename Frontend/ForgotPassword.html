<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <link rel="stylesheet" href="style.css">
    <title>Forgot Password</title>
</head>
<style>
    body{
        background: url("img/Background.jpg");
        background-size: cover;
        background-repeat: no-repeat;
        background-attachment: fixed;
        /* overflow: hidden; */
        overflow-y: auto;
    }

    p{
        margin-bottom: 20px;
        margin-top: -20px;
        color:rgba(255, 255, 255, 0.818);
        
    }
</style>
<body>
<div class="wrapper">
    <nav class="nav">
        <div class="nav-logo"><p>ZSP</p></div>
        <div class="nav-menu" id="navMenu">
            <ul>
                <li><a href="Home.html" class="link">Home</a></li>
                <li><a href="About.html" class="link">About</a></li>
                <li><a href="Booking.html" class="link">Book</a></li>
                <li><a href="Contact.html" class="link">Contact</a></li>
            </ul>
        </div>
        <div class="nav-button">
            <button class="btn white-btn" onclick="window.location.href='Login.html?view=login'">Login</button>
        </div>
        <div class="nav-menu-btn">
            <i class="bx bx-menu" onclick="myMenuFunction()"></i>
        </div>
    </nav>

    <div class="form-box">
        <!-- Login Form -->
        <div class="login-container" id="login">
            <div class="top">
                <header>Reset Password</header>
                <p>Enter your email and role to receive a password reset link.</p>
            </div>

            
            <div class="input-box">
                <select class="input-field" id="loginRoleSelect" required>
                    <option value="" disabled selected>Select Role</option>
                    <option value="admin">Admin</option>
                    <option value="coach">Coach</option>
                    <option value="athlete">Athlete</option>
                </select>
                <i class='bx bx-user-check'></i>
            </div>

            <div class="input-box">
                <input type="email" class="input-field" id="resetEmail" placeholder="Email" required>
                <i class="bx bx-user"></i>
            </div>

            <div class="input-box">
                <input type="submit" class="submit" id="resetBtn" value="Send Reset Link">
            </div>

        </div>
    </div>
</div>

<script>
    function myMenuFunction() {
        const i = document.getElementById("navMenu");
        i.className = i.className === "nav-menu" ? "nav-menu responsive" : "nav-menu";
    }

    document.addEventListener("DOMContentLoaded", () => {
        document.getElementById("resetBtn").addEventListener("click", async (e) => {
            e.preventDefault();
            const email = document.getElementById("resetEmail").value;
            const role = document.getElementById("loginRoleSelect").value;

            if (!email || !role) {
                alert("Please provide both email and role.");
                return;
            }

            try {
                const res = await fetch('http://localhost:5000/auth/forgot-password', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email, role })
                });

                const data = await res.json();
                if (res.ok) {
                    alert("Reset email sent if account exists.");
                } else {
                    alert(data.error || "Something went wrong.");
                }
            } catch (err) {
                alert("Error sending reset link.");
                console.error(err);
            }
        });
    });
</script>
</body>
</html>